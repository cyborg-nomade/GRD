# use cases

## 001. user logs in - (API OK)

-   **_primary actor_**: user (any level or group)
-   **_other actors_**: none
-   **_preconditions_**:
    -   none
-   **_trigger_**:
    -   user accesses system's url
-   **_basic flow_**:
    1. user enters username and password, clicks submit;
    2. user is authenticated against company's AD;
    3. user is authorized according to group and level (either existing within AD or saved in the system);
    4. a token is generated, containing these claim:
        - username
        - user's name
        - user's access level
        - user's access group
    5. user is redirected to its homepage, according to access level and group
-   **_alternate flow_**:
    -   if user's credentials are wrong (authentication fails):
        -   user is presented with proper error message;
    -   if user isn't allowed to access the system (authorization fails):
        -   user is presented with proper error message, instructing how to get acces if he has level;
    -   if any server in the system presents an error (system failure):
        -   user is presented with proper error message, if error isn't in frontend service;
        -   system attempts to send e-mail to developer, if possible;
-   **_data inputs_**: user's username and password
-   **_data outputs_**: user (data object) + token
-   **_side effects_**:
    -   creates the user data object, if the user is allowed to access the system but isn't registered yet;

## 002. user creates proposicao (API OK)

-   **_primary actor_**: user (any level or group)
-   **_other actors_**: gerente or diretor (of proposicao owner group)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
-   **_trigger_**:
    -   user fills form, clicks in "save" button and confirms it in modal;
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system saves proposicao data object to the database;
    4. an id is generated by the database;
    5. system returns proposicao data object with id, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao data object
-   **_data outputs_**: success message + registered proposicao data object with id
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to user, confirming creation;
        -   if user is subgerente:
            -   sends to gerente of proposicao owner group;
        -   if user is assessor-diretoria:
            -   send to diretor of proposicao owner group;
    -   system creates a change log for the actions

## 003. user edits proposicao (API OK)

-   **_primary actor_**: user (any level or group)
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   proposicao must be registered in the system, and belong to one of user's access groups;
    -   proposicao must not be in statuses: 4, 4.1 or 5.
-   **_trigger_**: user alters filled form, clicks in "save" button and confirms it in modal
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system checks if sent id exists in database, and fetches corresponding data object;
    4. system replaces existing data object with new one, and saves it to database;
    5. system returns edited proposicao data object, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if proposicao is in status 1.1;
        -   system show reason for repproval above the form;
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + new proposicao data object
-   **_data outputs_**: success message + edited proposicao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to user, confirming edition;
        -   if proposicao status is 0 or 1.1:
            -   if user is subgerente:
                -   sends to gerente of proposicao owner group;
            -   if user is assessor-diretoria:
                -   sends proposicao owner group's gerente, diretor and other assesores-diretoria, and to proposicao creator;
            -   if user is diretor:
                -   sends proposicao owner group's gerente and assesores-diretoria, and to proposicao creator;
        -   if proposicao status is in other valid statuses:
            -   sends to grg members, proposicao owner group's gerente, diretor and other assesores-diretoria, and to proposicao creator;
    -   system creates a change log for the actions

## 004. creator removes proposicao (API OK)

-   **_primary actor_**: user in proposicao's owner group
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   proposicao must be registered in the system, and belong to one of user's access groups;
    -   proposicao must be in statuses: 0 or 1.1.
-   **_trigger_**: user clicks in "remove" button and confirms it in modal
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent id exists in database, and fetches corresponding data object;
    3. system removes data object from database;
    4. system returns old proposicao data object, and a success message;
    5. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if proposicao is in status 1.1;
        -   system show reason for repproval above the form;
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id
-   **_data outputs_**: success message + removed proposicao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to user, confirming removal;
        -   if user is subgerente:
            -   sends to gerente of proposicao owner group;
        -   if user is assessor-diretoria:
            -   sends proposicao owner group's gerente, diretor and other assesores-diretoria, and to proposicao creator;
        -   if user is diretor:
            -   sends proposicao owner group's gerente and assesores-diretoria, and to proposicao creator;
    -   system creates a change log for the actions

## 005. gerente sends proposicao to approval (API OK)

-   **_primary actor_**: gerente
-   **_other actors_**: assessor-diretoria (of the owner group), diretor (of the owner group)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have gerente access level;
    -   proposicao must be registered in the system, and belong to gerente's access group;
    -   proposicao must be in statuses: 0 or 1.1;
    -   proposicao must be valid as to is mandatory fields;
-   **_trigger_**: gerente may alter filled form, clicks in "send to approval" button and confirms it in modal
-   **_basic flow_**:
    1. gerente is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system alters sent proposicao data object's status to 1;
    4. system checks if sent id exists in database, and fetches corresponding data object;
    5. system replaces existing data object with new one, and saves it to database;
    6. system returns edited proposicao data object, and a success message;
    7. gerente is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if proposicao is in status 1.1;
        -   system show reason for repproval above the form;
    -   if gerente doesn't have a valid token:
        -   gerente is presented with a proper error message, instructing it to login again;
        -   gerente is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   gerente is presented with a proper error message;
        -   gerente is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + proposicao data object
-   **_data outputs_**: success message + edited proposicao data object
-   **_side effects_**:
    -   system sends an email to user, confirming action, and to proposicao owner group's diretor and assessores-diretoria;
    -   system creates a change log for the actions

## 006. diretor (or assessor-diretoria) approves/repproves proposicao (API OK)

-   **_primary actor_**: diretor or assessor-diretoria
-   **_other actors_**: proposicao creator, gerente (of the owner group), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have diretor or assessor-diretoria access level;
    -   proposicao must be registered in the system, and belong to one of users's access group;
    -   proposicao must be in status 1;
    -   proposicao must be valid as to is mandatory fields;
-   **_trigger_**: user may alter filled form, clicks in "approve" or "repprove" button and confirms it in modal. if repprove, user fills motivation textarea
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system alters sent proposicao data object's status to 2 (if approved) or 1.1 (if repproved);
    4. system checks if sent id exists in database, and fetches corresponding data object;
    5. system replaces existing data object with new one, and saves it to database;
    6. system returns edited proposicao data object, and a success message;
    7. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + proposicao data object
-   **_data outputs_**: success message + edited proposicao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members, if approved;
    -   system creates a change log for the actions

## 007. grg includes proposicao in reuniao (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), other grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 2;
    -   proposicao must be valid as to is mandatory fields;
    -   reuniao must not be in status 5;
-   **_trigger_**: grg member may alter filled proposicao form, clicks in "include in reuniao" button, selects a reuniao from a list and confirms it in modal
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent proposicao and reuniao ids exist in database;
    3. system gets existing proposicao and reuniao data objects;
    4. system adds proposicao to reuniao's list of proposicoes;
    5. system adds reuniao to proposicao's reuniao field;
    6. system replaces existing data objects with altered ones, and saves them to database;
    7. system returns edited proposicao and reuniao data objects, and a success message;
    8. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member decides to send proposicao back to diretoria for review:
        1. grg member may alter filled form and clicks in "send back" button;
        2. in confirmation modal, system asks for a reason for sending back, and adds it to proposicao data object;
        3. grg member confirms activity in modal;
        4. grg member is authorized with token;
        5. system checks if sent object is of proposicao data type;
        6. system alters sent proposicao data object's status to _"Retornado pela GRG"_;
        7. system finds existing data object in database;
        8. system replaces existing data object with new one, and saves it to database;
        9. system returns edited proposicao data object, and a success message;
        10. grg member is presented a success message and redirected to proper list page;
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + reuniao id
-   **_data outputs_**: status message + proposicao + reuniao
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 008. grg coordinates vote for approval of a proposicao in reuniao presenting screen (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members, other diretores in reuniao
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 3;
    -   proposicao must be valid as to is mandatory fields;
    -   proposicao must included in a reuniao in status 3;
-   **_trigger_**: grg member clicks on "deliberate" button in a proposicao in reuniao presentation screen;
-   **_basic flow_**:
    1. a modal opens, showing the possible votes (approve/repprove/suspend/abstain) of all the participants in the reuniao, as well as text area for necessary fixes for the proposicao;
    2. grg member clicks on each of the participants' votes, annotates the necessary fixes;
    3. grg member click on "save votes" button;
    4. grg member is authorized with token;
    5. system checks if sent proposicao and diretor ids exist in database;
    6. system gets existing proposicao and diretor user data objects;
    7. system creates approval/repproval/suspension object with diretor user data and includes in proposicao data object;
    8. system calculates new proposicao status based on votes;
    9. system replaces existing proposicao data object with altered one, and saves it to database;
    10. system returns edited proposicao data object, and a success message;
    11. grg member is presented a success message and redirected to reuniao presenting screen, where proposicao already appears with new status;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + diretores ids + diretores votes + proposicao id
-   **_data outputs_**: status message + edited proposicao
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 009. diretor votes for approval of a proposicao in reuniao presenting screen (API OK)

-   **_primary actor_**: diretor
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members, other diretores in reuniao
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have diretor access level, and be a participant in the reuniao;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 3;
    -   proposicao must be valid as to is mandatory fields;
    -   proposicao must included in a reuniao in status 3;
-   **_trigger_**: diretor clicks on "deliberate" button in a proposicao in reuniao presentation screen;
-   **_basic flow_**:
    1. a modal opens, showing the possible votes (approve/repprove/suspend/abstain) of the diretor in the reuniao, as well as text area for necessary fixes for the proposicao;
    2. diretor clicks its vote, annotates the necessary fixes;
    3. diretor click on "save vote" button;
    4. diretor is authorized with token;
    5. system checks if sent proposicao and diretor id exist in database;
    6. system gets existing proposicao and diretor user data objects;
    7. system creates approval/repproval/suspension object with diretor user data and includes in proposicao data object;
    8. system calculates new proposicao status based on votes;
    9. system replaces existing proposicao data object with altered one, and saves it to database;
    10. system returns edited proposicao data object, and a success message;
    11. diretor is presented a success message and redirected to reuniao presenting screen, where proposicao already appears with new status;
-   **_alternate flow_**:
    -   if diretor doesn't have a valid token:
        -   diretor is presented with a proper error message, instructing it to login again;
        -   diretor is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   diretor is presented with a proper error message;
        -   diretor is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + diretores ids + diretores votes + proposicao id
-   **_data outputs_**: status message + edited proposicao
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 010. grg emits resolucao diretoria for proposicao (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 4 or 4.1;
    -   proposicao must be valid as to is mandatory fields;
    -   proposicao must included in a reuniao in status 4;
-   **_trigger_**: grg member clicks "emit resolucao diretoria" button, and selects a proposicao included in reuniao
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent proposicao id exists in database;
    3. system gets existing proposicao data object;
    4. system generates resolucao diretoria file based on model and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns resolucao diretoria file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: reuniao id + proposicao id
-   **_data outputs_**: status message + reuniao + resolucao diretoria file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
        -   sends to reuniao participants;
    -   system creates a change log for the actions

## 011. user sends proposicao to grg after rd fixes are requested (API OK)

-   **_primary actor_**: user (any level or group)
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   proposicao must be registered in the system, and belong to user's access group;
    -   proposicao must not be in statuses 4.2 ou 4.3.
    -   proposicao must be valid as to is mandatory fields;
    -   proposicao must included in a reuniao in status 4;
-   **_trigger_**: user alters filled form, clicks in "send to grg" button and confirms it in modal
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system alters sent proposicao data object's status to 4.2.1 or 4.3.1, depending on its previous status;
    4. system checks if sent id exists in database, and fetches corresponding data object;
    5. system replaces existing data object with new one, and saves it to database;
    6. system returns edited proposicao data object, and a success message;
    7. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + proposicao data object
-   **_data outputs_**: success message + edited proposicao data object
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 012. grg marks fixes done (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 4.2.1 or 4.3.1;
    -   proposicao must be valid as to is mandatory fields;
    -   proposicao must included in a reuniao in status 4;
-   **_trigger_**: grg member may alter filled form, clicks in "mark fixes as done" button and confirms it in modal
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent object is of proposicao data type;
    3. system alters sent proposicao data object's status to 4 or 2, depending on its previous status;
    4. system checks if sent id exists in database, and fetches corresponding data object;
    5. system replaces existing data object with new one, and saves it to database;
    6. system returns edited proposicao data object, and a success message;
    7. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + proposicao data object
-   **_data outputs_**: success message + edited proposicao data object
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 013. user searches for a proposicao in a list (API OK)

-   **_primary actor_**: user (any level or group)
-   **_other actors_**: none
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
-   **_trigger_**: user navigates to a page that contains a list of proposicoes, may select a filter
-   **_basic flow_**:
    1. user is authorizes with token;
    2. system receives specified filter and fetches list of proposicoes matching from database;
    3. system returns a list of proposicoes in reduced format;
    4. user is presented a searcheable, filterable list of proposicoes;
    5. if user clicks a row, system redirects to proposicao form for the selected proposicao;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if sent object is not of proposicao data type or there's another system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: defined filters
-   **_data outputs_**: list of proposicoes
-   **_side effects_**: none

## 014. grg creates reuniao (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: other grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   reuniao form must be valid as to is mandatory fields;
-   **_trigger_**: grg member fills form, clicks in "save" button and confirms it in modal;
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent object is of reuniao data type;
    3. system saves reuniao data object to the database;
    4. an id is generated by the database;
    5. system returns reuniao data object with id, and a success message;
    6. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao data object
-   **_data outputs_**: success message + registered reuniao data object with id
-   **_side effects_**:
    -   system creates a change log for the actions

## 015. grg edits reuniao (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: other grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   reuniao form must be valid as to is mandatory fields;
    -   reuniao must not be in status: 5.
-   **_trigger_**: grg member alters filled form, clicks in "save changes" button and confirms it in modal
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent object is of reuniao data type;
    3. system checks if sent id exists in database, and fetches corresponding data object;
    4. system replaces existing data object with new one, and saves it to database;
    5. system returns edited reuniao data object, and a success message;
    6. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id + reuniao data object
-   **_data outputs_**: success message + edited reuniao data object
-   **_side effects_**:
    -   system creates a change log for the actions

## 016. grg add proposicao to reuniao (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), other grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status: 2;
    -   proposicao must be valid as to is mandatory fields;
    -   reuniao must not be in status: 5;
-   **_trigger_**: grg member may alter filled reuniao form, clicks in "include proposicao" button, selects a proposicao reuniao from a list and confirms it in modal
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent proposicao and reuniao ids exist in database;
    3. system gets existing proposicao and reuniao data objects;
    4. system adds proposicao to reuniao's list of proposicoes;
    5. system adds reuniao to proposicao's reuniao field;
    6. system replaces existing data objects with altered ones, and saves them to database;
    7. system returns edited proposicao and reuniao data objects, and a success message;
    8. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + reuniao id
-   **_data outputs_**: status message + proposicao + reuniao
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
    -   system creates a change log for the actions

## 017. grg emits pauta previa (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: assessor-diretoria (participating in reuniao previa), diretor (participating in reuniao), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 1;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member clicks "emit pauta previa" button
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent reuniao id exists in database;
    3. system gets existing reuniao data object, with its related proposicao data objects;
    4. system generates pauta previa file based on model and reuniao's and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns pauta previa file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: status message + reuniao + pauta file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to other grg members;
        -   sends to reuniao participants;
        -   sends to reuniao previa participants;
    -   system creates a change log for the actions

## 018. grg (or assessor-diretoria) annotates proposicao in reuniao previa

-   **_primary actor_**: grg member or assessor-diretoria
-   **_other actors_**: (other) grg members or assessor-diretoria assessor-diretoria (participating in reuniao previa)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg, diretor or assessor-diretoria access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 3;
    -   proposicao must be valid as to is mandatory fields;
    -   reuniao must be in status 3;
-   **_trigger_**: user member clicks on "annotate" button in a proposicao in reuniao previa presentation screen;
-   **_basic flow_**:
    1. a modal opens, showing a text area for annotations;
    2. user writes down annotation;
    3. user click on "save annotation" button;
    4. user is authorized with token;
    5. system checks if sent proposicao data object is of proposicao data type;
    6. system checks if sent id exists in database, and fetches corresponding data object;
    7. system includes annatation text in proposicao data object;
    8. system replaces existing proposicao data object with altered one, and saves it to database;
    9. system returns edited proposicao data object, and a success message;
    10. user is presented a success message and redirected to reuniao previa presenting screen;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + proposicao data object
-   **_data outputs_**: status message + edited proposicao
-   **_side effects_**:
    -   system creates a change log for the actions

## 019. grg emits memoria previa (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: assessor-diretoria (participating in reuniao previa), diretor (participating in reuniao), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 2;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member clicks "emit memoria previa" button
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent reuniao id exists in database;
    3. system gets existing reuniao data object, with its related proposicao data objects;
    4. system generates memoria previa file based on model and reuniao's and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns memoria previa file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: status message + reuniao + memoria previa file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to other grg members;
        -   sends to reuniao participants;
        -   sends to reuniao previa participants;
    -   system creates a change log for the actions

## 020. grg emits pauta definitiva (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: assessor-diretoria (participating in reuniao previa), diretor (participating in reuniao), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 3;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member clicks "emit pauta definitiva" button
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent reuniao id exists in database;
    3. system gets existing reuniao data object, with its related proposicao data objects;
    4. system generates pauta definitiva file based on model and reuniao's and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns pauta definitiva file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: status message + reuniao + pauta definitiva file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to other grg members;
        -   sends to reuniao participants;
        -   sends to reuniao previa participants;
    -   system creates a change log for the actions

## 021. grg (or diretor) opens reuniao presentation screen

-   **_primary actor_**: grg member or diretor (participating in reuniao)
-   **_other actors_**: none
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg or diretor access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 3;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member or diretor clicks the "present reuniao" button
-   **_basic flow_**:
    1. user is authorizes with token;
    2. system reuniao id and fetches its list of proposicoes;
    3. system returns a list of proposicoes in resumed format;
    4. user is presented a list of proposicoes;
    5. if user clicks a row, system redirects to proposicao form for the selected proposicao;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: list of proposicoes
-   **_side effects_**: none

## 022. grg adds proposicao to reuniao retroactively

-   **_primary actor_**: grg member
-   **_other actors_**: gerente (of the owner group), assessor-diretoria (of the owner group), diretor (of the owner group), other grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   proposicao must be registered in the system;
    -   proposicao must be in status 2;
    -   proposicao must be valid as to is mandatory fields;
    -   reuniao must be in status 4;
-   **_trigger_**: grg member may alter filled reuniao form, clicks in "include proposicao" button, selects a proposicao reuniao from a list and confirms it in modal
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent proposicao and reuniao ids exist in database;
    3. system gets existing proposicao and reuniao data objects;
    4. system adds proposicao to reuniao's list of proposicoes;
    5. system adds reuniao to proposicao's reuniao field;
    6. system replaces existing data objects with altered ones, and saves them to database;
    7. system returns edited proposicao and reuniao data objects, and a success message;
    8. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + proposicao id + reuniao id
-   **_data outputs_**: status message + proposicao + reuniao
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to proposicao creator user;
        -   sends to proposicao owner group's gerente, assessores-diretoria and diretor;
        -   sends to grg members;
        -   sends to reuniao participants;
    -   system creates a change log for the actions

## 023. grg emits relatorio deliberativo (API OK)

-   **_primary actor_**: grg member
-   **_other actors_**: assessor-diretoria (participating in reuniao previa), diretor (participating in reuniao), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 4;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member clicks "emit relatorio deliberativo" button
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent reuniao id exists in database;
    3. system gets existing reuniao data object, with its related proposicao data objects;
    4. system generates relatorio deliberativo file based on model and reuniao's and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns relatorio deliberativo file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: status message + reuniao + relatorio deliberativo file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to other grg members;
        -   sends to reuniao participants;
        -   sends to reuniao previa participants;
    -   system creates a change log for the actions

## 024. grg emits ata

-   **_primary actor_**: grg member
-   **_other actors_**: assessor-diretoria (participating in reuniao previa), diretor (participating in reuniao), grg members
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member access level;
    -   reuniao must be registered in the system;
    -   reuniao must be in status 4;
    -   reuniao must be valid as to is mandatory fields;
-   **_trigger_**: grg member clicks "emit ata" button
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent reuniao id exists in database;
    3. system gets existing reuniao data object, with its related proposicao data objects;
    4. system generates ata file based on model and reuniao's and proposicao's data;
    5. system saves file to properly named folder in server;
    6. system returns ata file, and a success message;
    7. file is automatically downloaded into grg member's desktop;
-   **_alternate flow_**:
    -   if grg member doesn't have a valid token:
        -   grg member is presented with a proper error message, instructing it to login again;
        -   grg member is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   grg member is presented with a proper error message;
        -   grg member is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + reuniao id
-   **_data outputs_**: status message + reuniao + ata file
-   **_side effects_**:
    -   system sends an email to proper parties with generated file attached, according to rules:
        -   sends to other grg members;
        -   sends to reuniao participants;
        -   sends to reuniao previa participants;
    -   system creates a change log for the actions

## 025. grg searches for a reuniao in a list

-   **_primary actor_**: grg member (or, more rarely, diretor before participating in reuniao)
-   **_other actors_**: none
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg member or diretor access level;
-   **_trigger_**: user navigates to a page that contains a list of reunioes, may select a filter
-   **_basic flow_**:
    1. user is authorizes with token;
    2. system receives specified filter and fetches list of reuniao matching from database;
    3. system returns a list of reuniao in resumed format;
    4. user is presented a searcheable, filterable list of reuniao;
    5. if user clicks a row, system redirects to reuniao form for the selected reuniao;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: defined filters
-   **_data outputs_**: list of reunioes
-   **_side effects_**: none

## 026. grg includes acoes in reuniao

-   **_primary actor_**: grg member
-   **_other actors_**: responsavel (user designated to an acao), other grg members, diretores (participating in reuniao where acao has been included)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   acao form must be filled validly as to is mandatory fields;
    -   reuniao must not be in status 5;
-   **_trigger_**: user click in "add acao" button in a reuniao;
-   **_basic flow_**:
    1. an acao form is opened in a modal;
    2. grg member fills acao form;
    3. grg member clicks "add" button in modal
    4. grg member is authorized with token;
    5. system checks if sent object is of acao data type;
    6. system saves acao data object to the database;
    7. an id is generated by the database;
    8. system checks if sent reuniao id exist in database;
    9. system adds acao to reuniao's list of acoes;
    10. system adds reuniao to acao's list of reunioes;
    11. system replaces existing data objects with altered ones, and saves them to database;
    12. system returns acao data object with id, edited reuniao object and a success message;
    13. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + acao data object + reuniao id
-   **_data outputs_**: reuniao data object + acao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to user, confirming creation;
        -   sends to reuniao participants;
        -   sends to grg members;
        -   sends to responsavel (user designated to an acao);
    -   system creates a change log for the actions

## 027. responsavel adds andamentos to an acao

-   **_primary actor_**: responsavel (user designated to an acao)
-   **_other actors_**: grg members, diretores (participating in reuniao where acao has been included)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   andamento form must be filled validly as to is mandatory fields;
    -   acao must be in status 0 or 1;
-   **_trigger_**: user click in "add andamento" button in a acao;
-   **_basic flow_**:
    1. an andamento form is opened in a modal;
    2. responsavel fills andamento form;
    3. responsavel clicks "add" button in modal
    4. responsavel is authorized with token;
    5. system checks if sent object is of andamento data type;
    6. system saves andamento data object to the database;
    7. an id is generated by the database;
    8. system checks if sent acao id exist in database;
    9. system adds andamento to acao's list of andamentos;
    10. system replaces existing data objects with altered ones, and saves them to database;
    11. system returns edited acao object and a success message;
    12. responsavel is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + andamento data object + acao id
-   **_data outputs_**: acao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to user, confirming inclusion;
        -   sends to grg members;
        -   sends to diretores (participating in reuniao where acao has been included);
    -   system creates a change log for the actions

## 028. grg marks acao as concluded

-   **_primary actor_**: grg member
-   **_other actors_**: responsavel (user designated to an acao), diretores (participating in reuniao where acao has been included)
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
    -   acao form must be filled validly as to is mandatory fields;
    -   acao must be in status 1;
-   **_trigger_**: user click in "end acao" button in a reuniao, and confirms in a modal;
-   **_basic flow_**:
    1. grg member is authorized with token;
    2. system checks if sent acao id exists in database;
    3. system changes acao status accordingly;
    4. system replaces existing data objects with altered ones, and saves them to database;
    5. system returns edited acao object and a success message;
    6. grg member is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + acao id
-   **_data outputs_**: status message + acao data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to responsavel (user designated to an acao);
        -   sends to other grg members;
        -   sends to diretores (participating in reuniao where acao has been included);
    -   system creates a change log for the actions

## 029. gerente adds user as subgerente

-   **_primary actor_**: gerente
-   **_other actors_**: subgerente
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have gerente access level;
-   **_trigger_**: gerente selects an existing AD user from a list and clicks "add as sub" button
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent username exists in AD;
    3. system creates user data object with proper acess level and groups and saves it to the database;
    4. an id is generated by the database;
    5. system returns user data object with id, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + username to add
-   **_data outputs_**: added user data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to just added subgerente;
        -   sends to user, confirming inclusion;
    -   system creates a change log for the actions

## 030. diretor adds user as assessor-diretoria

-   **_primary actor_**: diretor
-   **_other actors_**: assessor-diretoria
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have diretor access level;
-   **_trigger_**: diretor selects an existing AD user from a list and clicks "add as assessor" button
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent username exists in AD;
    3. system creates user data object with proper acess level and groups and saves it to the database;
    4. an id is generated by the database;
    5. system returns user data object with id, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + username to add
-   **_data outputs_**: added user data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to just added assessor;
        -   sends to user, confirming inclusion;
    -   system creates a change log for the actions

## 031. grg (or sysadmin) adds a user

-   **_primary actor_**: grg member or sysadmin
-   **_other actors_**: user added
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
-   **_trigger_**: grg member selects an existing AD user from a list and clicks "add user" button
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent username exists in AD;
    3. system creates user data object with proper acess level and groups and saves it to the database;
    4. an id is generated by the database;
    5. system returns user data object with id, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + username to add
-   **_data outputs_**: addeduser data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to just added new user;
        -   sends to user, confirming inclusion
    -   system creates a change log for the actions

## 032. grg (or sysadmin) edits a user

-   **_primary actor_**: grg member or sysadmin
-   **_other actors_**: user added
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
-   **_trigger_**: grg member selects an existing user from a list, selects access level and groups, and clicks "edit user" button
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent user id exists in database and fetches it;
    3. system checks if received user data object if valid, and replaces the old one with the new;
    4. system saves new user data object to the database;
    5. system returns user data object with id, and a success message;
    6. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: token + user id + user data object
-   **_data outputs_**: edited user data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to just added new user;
        -   sends to user, confirming edition;
    -   system creates a change log for the actions

## 033. grg (or sysadmin) removes a user

-   **_primary actor_**: grg member or sysadmin
-   **_preconditions_**:
    -   user must be registered in the system and have non-expired token;
    -   user must have grg access level;
-   **_trigger_**: grg member selects an existing user from a list, clicks "remove user" button
-   **_basic flow_**:
    1. user is authorized with token;
    2. system checks if sent user id exists in database and removes it;
    3. system returns removed user data object without id, and a success message;
    4. user is presented a success message and redirected to proper list page;
-   **_alternate flow_**:
    -   if user doesn't have a valid token:
        -   user is presented with a proper error message, instructing it to login again;
        -   user is logged out of system, and redirected to login page;
    -   if there's any system error:
        -   user is presented with a proper error message;
        -   user is redirected to filled form, and instructed to try again;
        -   an e-mail is sent to developer, informing of system error;
-   **_data inputs_**: user id
-   **_data outputs_**: user data object
-   **_side effects_**:
    -   system sends an email to proper parties, according to rules:
        -   sends to just removed user;
        -   sends to user, conforming removal;
    -   system creates a change log for the actions
